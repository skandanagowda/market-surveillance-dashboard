[0m03:30:15.284581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c707170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c2cc500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c303080>]}


============================== 03:30:15.290542 | 4a2781e0-5d88-4799-8f3c-c14c5f99f92d ==============================
[0m03:30:15.290542 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m03:30:15.291042 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/dbt', 'log_path': '/opt/dbt/logs', 'target_path': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'profiles_dir': '/opt/dbt', 'fail_fast': 'False', 'introspect': 'True', 'static_parser': 'True', 'use_colors': 'True', 'quiet': 'False', 'log_format': 'default', 'write_json': 'True'}
[0m03:30:15.501606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a2781e0-5d88-4799-8f3c-c14c5f99f92d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c907860>]}
[0m03:30:15.541752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a2781e0-5d88-4799-8f3c-c14c5f99f92d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b95cf50>]}
[0m03:30:15.542941 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:30:15.611357 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m03:30:15.612055 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:30:15.612342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4a2781e0-5d88-4799-8f3c-c14c5f99f92d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae33bf0>]}
[0m03:30:16.195896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a2781e0-5d88-4799-8f3c-c14c5f99f92d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a8a1190>]}
[0m03:30:16.254975 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m03:30:16.257397 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m03:30:16.306627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a2781e0-5d88-4799-8f3c-c14c5f99f92d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7acf95b0>]}
[0m03:30:16.307036 [info ] [MainThread]: Found 2 models, 446 macros
[0m03:30:16.307403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a2781e0-5d88-4799-8f3c-c14c5f99f92d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7baf6930>]}
[0m03:30:16.308732 [info ] [MainThread]: 
[0m03:30:16.309463 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:30:16.309715 [info ] [MainThread]: 
[0m03:30:16.310205 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:30:16.313033 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m03:30:16.380014 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m03:30:16.380460 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m03:30:16.380738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:30:16.413494 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.033 seconds
[0m03:30:16.415035 [debug] [ThreadPool]: On list_airflow: Close
[0m03:30:16.416519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m03:30:16.420883 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m03:30:16.421239 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m03:30:16.421472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:30:16.431542 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m03:30:16.432047 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m03:30:16.432410 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:30:16.454046 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.021 seconds
[0m03:30:16.456055 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m03:30:16.456573 [debug] [ThreadPool]: On list_airflow_public: Close
[0m03:30:16.463771 [debug] [MainThread]: Using postgres connection "master"
[0m03:30:16.464186 [debug] [MainThread]: On master: BEGIN
[0m03:30:16.464406 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:30:16.476336 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m03:30:16.476722 [debug] [MainThread]: Using postgres connection "master"
[0m03:30:16.477661 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:30:16.503302 [debug] [MainThread]: SQL status: SELECT 0 in 0.025 seconds
[0m03:30:16.504318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a2781e0-5d88-4799-8f3c-c14c5f99f92d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d28d70>]}
[0m03:30:16.504723 [debug] [MainThread]: On master: ROLLBACK
[0m03:30:16.505066 [debug] [MainThread]: Using postgres connection "master"
[0m03:30:16.505269 [debug] [MainThread]: On master: BEGIN
[0m03:30:16.505592 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:30:16.505885 [debug] [MainThread]: On master: COMMIT
[0m03:30:16.506132 [debug] [MainThread]: Using postgres connection "master"
[0m03:30:16.506405 [debug] [MainThread]: On master: COMMIT
[0m03:30:16.506724 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:30:16.507044 [debug] [MainThread]: On master: Close
[0m03:30:16.511766 [debug] [Thread-1 (]: Began running node model.market_mvp.fact_bars_1m
[0m03:30:16.512318 [info ] [Thread-1 (]: 1 of 2 START sql view model public.fact_bars_1m ................................ [RUN]
[0m03:30:16.512795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.market_mvp.fact_bars_1m)
[0m03:30:16.513196 [debug] [Thread-1 (]: Began compiling node model.market_mvp.fact_bars_1m
[0m03:30:16.518088 [debug] [Thread-1 (]: Writing injected SQL for node "model.market_mvp.fact_bars_1m"
[0m03:30:16.520009 [debug] [Thread-1 (]: Began executing node model.market_mvp.fact_bars_1m
[0m03:30:16.550668 [debug] [Thread-1 (]: Writing runtime sql for node "model.market_mvp.fact_bars_1m"
[0m03:30:16.553226 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:30:16.553709 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: BEGIN
[0m03:30:16.554019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:30:16.558384 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m03:30:16.558850 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:30:16.559146 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_bars_1m"} */

  create view "airflow"."public"."fact_bars_1m__dbt_tmp"
    
    
  as (
    with t as (
  select symbol, date_trunc('minute', ts) as ts_min, price, size
  from stg_trades
),
agg as (
  select
    symbol, ts_min as ts,
    min(price) as low,
    max(price) as high,
    sum(size) as volume,
    (array_agg(price order by ts_min, ts))[1] as open,
    (array_agg(price order by ts_min, ts))[array_length(array_agg(price order by ts_min, ts),1)] as close
  from (
    select symbol, ts_min, price, size,
           row_number() over (partition by symbol, ts_min order by ts) as rn
    from t
  ) x
  group by symbol, ts_min
)
select symbol, ts, open, high, low, close, volume from agg;
  );
[0m03:30:16.560368 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 26: select symbol, ts, open, high, low, close, volume from agg;
                                                                   ^

[0m03:30:16.560817 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: ROLLBACK
[0m03:30:16.561429 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: Close
[0m03:30:16.570268 [debug] [Thread-1 (]: Database Error in model fact_bars_1m (models/fact_bars_1m.sql)
  syntax error at or near ";"
  LINE 26: select symbol, ts, open, high, low, close, volume from agg;
                                                                     ^
  compiled code at target/run/market_mvp/models/fact_bars_1m.sql
[0m03:30:16.572272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a2781e0-5d88-4799-8f3c-c14c5f99f92d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7acfbd70>]}
[0m03:30:16.572815 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.fact_bars_1m ....................... [[31mERROR[0m in 0.06s]
[0m03:30:16.573329 [debug] [Thread-1 (]: Finished running node model.market_mvp.fact_bars_1m
[0m03:30:16.573633 [debug] [Thread-1 (]: Began running node model.market_mvp.fact_factors
[0m03:30:16.573950 [debug] [Thread-4 (]: Marking all children of 'model.market_mvp.fact_bars_1m' to be skipped because of status 'error'.  Reason: Database Error in model fact_bars_1m (models/fact_bars_1m.sql)
  syntax error at or near ";"
  LINE 26: select symbol, ts, open, high, low, close, volume from agg;
                                                                     ^
  compiled code at target/run/market_mvp/models/fact_bars_1m.sql.
[0m03:30:16.574276 [info ] [Thread-1 (]: 2 of 2 START sql view model public.fact_factors ................................ [RUN]
[0m03:30:16.575442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.market_mvp.fact_bars_1m, now model.market_mvp.fact_factors)
[0m03:30:16.575826 [debug] [Thread-1 (]: Began compiling node model.market_mvp.fact_factors
[0m03:30:16.577772 [debug] [Thread-1 (]: Writing injected SQL for node "model.market_mvp.fact_factors"
[0m03:30:16.578586 [debug] [Thread-1 (]: Began executing node model.market_mvp.fact_factors
[0m03:30:16.580698 [debug] [Thread-1 (]: Writing runtime sql for node "model.market_mvp.fact_factors"
[0m03:30:16.581296 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_factors"
[0m03:30:16.581523 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: BEGIN
[0m03:30:16.581738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:30:16.585522 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m03:30:16.585821 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_factors"
[0m03:30:16.586112 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_factors"} */

  create view "airflow"."public"."fact_factors__dbt_tmp"
    
    
  as (
    with q as (
  select symbol, ts, (bid+ask)/2.0 as mid, (ask-bid) as spread
  from stg_quotes
),
f as (
  select
    symbol, ts,
    10000*spread/nullif(mid,0) as spread_bp,
    stddev_samp(mid) over (partition by symbol order by ts rows between 5 preceding and current row) as vol_5m,
    stddev_samp(mid) over (partition by symbol order by ts rows between 30 preceding and current row) as vol_30m,
    mid as fair_value
  from q
)
select * from f;
  );
[0m03:30:16.586525 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 20: select * from f;
                        ^

[0m03:30:16.586792 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: ROLLBACK
[0m03:30:16.587186 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: Close
[0m03:30:16.588541 [debug] [Thread-1 (]: Database Error in model fact_factors (models/fact_factors.sql)
  syntax error at or near ";"
  LINE 20: select * from f;
                          ^
  compiled code at target/run/market_mvp/models/fact_factors.sql
[0m03:30:16.588897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a2781e0-5d88-4799-8f3c-c14c5f99f92d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a1919d0>]}
[0m03:30:16.589277 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.fact_factors ....................... [[31mERROR[0m in 0.01s]
[0m03:30:16.589967 [debug] [Thread-1 (]: Finished running node model.market_mvp.fact_factors
[0m03:30:16.590363 [debug] [Thread-4 (]: Marking all children of 'model.market_mvp.fact_factors' to be skipped because of status 'error'.  Reason: Database Error in model fact_factors (models/fact_factors.sql)
  syntax error at or near ";"
  LINE 20: select * from f;
                          ^
  compiled code at target/run/market_mvp/models/fact_factors.sql.
[0m03:30:16.591332 [debug] [MainThread]: Using postgres connection "master"
[0m03:30:16.591693 [debug] [MainThread]: On master: BEGIN
[0m03:30:16.591961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:30:16.596662 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m03:30:16.597041 [debug] [MainThread]: On master: COMMIT
[0m03:30:16.597284 [debug] [MainThread]: Using postgres connection "master"
[0m03:30:16.597495 [debug] [MainThread]: On master: COMMIT
[0m03:30:16.597748 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:30:16.598014 [debug] [MainThread]: On master: Close
[0m03:30:16.598321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:30:16.598625 [debug] [MainThread]: Connection 'model.market_mvp.fact_factors' was properly closed.
[0m03:30:16.599056 [info ] [MainThread]: 
[0m03:30:16.599374 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m03:30:16.599970 [debug] [MainThread]: Command end result
[0m03:30:16.619662 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m03:30:16.621211 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m03:30:16.625033 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m03:30:16.625267 [info ] [MainThread]: 
[0m03:30:16.625552 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m03:30:16.625851 [info ] [MainThread]: 
[0m03:30:16.626192 [error] [MainThread]: [31mFailure in model fact_bars_1m (models/fact_bars_1m.sql)[0m
[0m03:30:16.626463 [error] [MainThread]:   Database Error in model fact_bars_1m (models/fact_bars_1m.sql)
  syntax error at or near ";"
  LINE 26: select symbol, ts, open, high, low, close, volume from agg;
                                                                     ^
  compiled code at target/run/market_mvp/models/fact_bars_1m.sql
[0m03:30:16.626728 [info ] [MainThread]: 
[0m03:30:16.627087 [info ] [MainThread]:   compiled code at target/compiled/market_mvp/models/fact_bars_1m.sql
[0m03:30:16.627314 [info ] [MainThread]: 
[0m03:30:16.627559 [error] [MainThread]: [31mFailure in model fact_factors (models/fact_factors.sql)[0m
[0m03:30:16.627805 [error] [MainThread]:   Database Error in model fact_factors (models/fact_factors.sql)
  syntax error at or near ";"
  LINE 20: select * from f;
                          ^
  compiled code at target/run/market_mvp/models/fact_factors.sql
[0m03:30:16.628033 [info ] [MainThread]: 
[0m03:30:16.628311 [info ] [MainThread]:   compiled code at target/compiled/market_mvp/models/fact_factors.sql
[0m03:30:16.628567 [info ] [MainThread]: 
[0m03:30:16.628848 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m03:30:16.634670 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3812485, "process_in_blocks": "27936", "process_kernel_time": 1.251037, "process_mem_max_rss": "124108", "process_out_blocks": "4944", "process_user_time": 2.580969}
[0m03:30:16.635197 [debug] [MainThread]: Command `dbt run` failed at 03:30:16.635129 after 1.38 seconds
[0m03:30:16.635507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b94a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c571d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a9cd820>]}
[0m03:30:16.635819 [debug] [MainThread]: Flushing usage events
[0m03:30:16.987403 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:34:34.125260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d651f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8813c620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff859947a0>]}


============================== 03:34:34.131978 | 0cd7bcd2-c196-47df-9611-dfbbbf22f405 ==============================
[0m03:34:34.131978 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m03:34:34.132335 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'target_path': 'None', 'partial_parse': 'True', 'no_print': 'None', 'profiles_dir': '/opt/dbt', 'invocation_command': 'dbt run --profiles-dir /opt/dbt -q', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'printer_width': '80', 'use_experimental_parser': 'False', 'use_colors': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'quiet': 'True', 'empty': 'False', 'debug': 'False', 'introspect': 'True', 'log_path': '/opt/dbt/logs'}
[0m03:34:34.278848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cd7bcd2-c196-47df-9611-dfbbbf22f405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8632a390>]}
[0m03:34:34.321417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cd7bcd2-c196-47df-9611-dfbbbf22f405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84f1eae0>]}
[0m03:34:34.322339 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:34:34.377987 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m03:34:34.438801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:34:34.439307 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:34:34.458901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cd7bcd2-c196-47df-9611-dfbbbf22f405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff843bbf50>]}
[0m03:34:34.500785 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m03:34:34.502237 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m03:34:34.552697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cd7bcd2-c196-47df-9611-dfbbbf22f405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84043410>]}
[0m03:34:34.553244 [info ] [MainThread]: Found 2 models, 446 macros
[0m03:34:34.553485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cd7bcd2-c196-47df-9611-dfbbbf22f405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86453e00>]}
[0m03:34:34.554618 [info ] [MainThread]: 
[0m03:34:34.554893 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:34:34.555071 [info ] [MainThread]: 
[0m03:34:34.555479 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:34:34.557966 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m03:34:34.587129 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m03:34:34.587601 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m03:34:34.587918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:34:34.595276 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m03:34:34.596305 [debug] [ThreadPool]: On list_airflow: Close
[0m03:34:34.597309 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m03:34:34.600814 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m03:34:34.601166 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m03:34:34.601376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:34:34.611192 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m03:34:34.611926 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m03:34:34.612330 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:34:34.616443 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.004 seconds
[0m03:34:34.618294 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m03:34:34.619658 [debug] [ThreadPool]: On list_airflow_public: Close
[0m03:34:34.627846 [debug] [MainThread]: Using postgres connection "master"
[0m03:34:34.628466 [debug] [MainThread]: On master: BEGIN
[0m03:34:34.628718 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:34:34.633700 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m03:34:34.634164 [debug] [MainThread]: Using postgres connection "master"
[0m03:34:34.634485 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:34:34.650178 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m03:34:34.651354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cd7bcd2-c196-47df-9611-dfbbbf22f405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84062480>]}
[0m03:34:34.651879 [debug] [MainThread]: On master: ROLLBACK
[0m03:34:34.652347 [debug] [MainThread]: Using postgres connection "master"
[0m03:34:34.652611 [debug] [MainThread]: On master: BEGIN
[0m03:34:34.653143 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:34:34.653389 [debug] [MainThread]: On master: COMMIT
[0m03:34:34.653601 [debug] [MainThread]: Using postgres connection "master"
[0m03:34:34.653869 [debug] [MainThread]: On master: COMMIT
[0m03:34:34.654297 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:34:34.654596 [debug] [MainThread]: On master: Close
[0m03:34:34.658931 [debug] [Thread-1 (]: Began running node model.market_mvp.fact_bars_1m
[0m03:34:34.659580 [info ] [Thread-1 (]: 1 of 2 START sql view model public.fact_bars_1m ................................ [RUN]
[0m03:34:34.660008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.market_mvp.fact_bars_1m)
[0m03:34:34.660318 [debug] [Thread-1 (]: Began compiling node model.market_mvp.fact_bars_1m
[0m03:34:34.664604 [debug] [Thread-1 (]: Writing injected SQL for node "model.market_mvp.fact_bars_1m"
[0m03:34:34.666089 [debug] [Thread-1 (]: Began executing node model.market_mvp.fact_bars_1m
[0m03:34:34.690935 [debug] [Thread-1 (]: Writing runtime sql for node "model.market_mvp.fact_bars_1m"
[0m03:34:34.692223 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:34:34.692620 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: BEGIN
[0m03:34:34.693008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:34:34.698654 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m03:34:34.699114 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:34:34.699450 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_bars_1m"} */

  create view "airflow"."public"."fact_bars_1m__dbt_tmp"
    
    
  as (
    with t as (
  select symbol, date_trunc('minute', ts) as ts_min, price, size
  from stg_trades
),
agg as (
  select
    symbol, ts_min as ts,
    min(price) as low,
    max(price) as high,
    sum(size) as volume,
    (array_agg(price order by ts_min, ts))[1] as open,
    (array_agg(price order by ts_min, ts))[array_length(array_agg(price order by ts_min, ts),1)] as close
  from (
    select symbol, ts_min, price, size,
           row_number() over (partition by symbol, ts_min order by ts) as rn
    from t
  ) x
  group by symbol, ts_min
)
select symbol, ts, open, high, low, close, volume from agg;
  );
[0m03:34:34.700195 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 26: select symbol, ts, open, high, low, close, volume from agg;
                                                                   ^

[0m03:34:34.700544 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: ROLLBACK
[0m03:34:34.701000 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: Close
[0m03:34:34.705022 [debug] [Thread-1 (]: Database Error in model fact_bars_1m (models/fact_bars_1m.sql)
  syntax error at or near ";"
  LINE 26: select symbol, ts, open, high, low, close, volume from agg;
                                                                     ^
  compiled code at target/run/market_mvp/models/fact_bars_1m.sql
[0m03:34:34.706783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cd7bcd2-c196-47df-9611-dfbbbf22f405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff833ac7a0>]}
[0m03:34:34.707394 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.fact_bars_1m ....................... [[31mERROR[0m in 0.05s]
[0m03:34:34.708120 [debug] [Thread-1 (]: Finished running node model.market_mvp.fact_bars_1m
[0m03:34:34.708555 [debug] [Thread-1 (]: Began running node model.market_mvp.fact_factors
[0m03:34:34.708894 [debug] [Thread-4 (]: Marking all children of 'model.market_mvp.fact_bars_1m' to be skipped because of status 'error'.  Reason: Database Error in model fact_bars_1m (models/fact_bars_1m.sql)
  syntax error at or near ";"
  LINE 26: select symbol, ts, open, high, low, close, volume from agg;
                                                                     ^
  compiled code at target/run/market_mvp/models/fact_bars_1m.sql.
[0m03:34:34.709277 [info ] [Thread-1 (]: 2 of 2 START sql view model public.fact_factors ................................ [RUN]
[0m03:34:34.710276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.market_mvp.fact_bars_1m, now model.market_mvp.fact_factors)
[0m03:34:34.710544 [debug] [Thread-1 (]: Began compiling node model.market_mvp.fact_factors
[0m03:34:34.712143 [debug] [Thread-1 (]: Writing injected SQL for node "model.market_mvp.fact_factors"
[0m03:34:34.713715 [debug] [Thread-1 (]: Began executing node model.market_mvp.fact_factors
[0m03:34:34.718183 [debug] [Thread-1 (]: Writing runtime sql for node "model.market_mvp.fact_factors"
[0m03:34:34.721599 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_factors"
[0m03:34:34.722042 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: BEGIN
[0m03:34:34.722366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:34:34.742894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m03:34:34.744616 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_factors"
[0m03:34:34.746099 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_factors"} */

  create view "airflow"."public"."fact_factors__dbt_tmp"
    
    
  as (
    with q as (
  select symbol, ts, (bid+ask)/2.0 as mid, (ask-bid) as spread
  from stg_quotes
),
f as (
  select
    symbol, ts,
    10000*spread/nullif(mid,0) as spread_bp,
    stddev_samp(mid) over (partition by symbol order by ts rows between 5 preceding and current row) as vol_5m,
    stddev_samp(mid) over (partition by symbol order by ts rows between 30 preceding and current row) as vol_30m,
    mid as fair_value
  from q
)
select * from f;
  );
[0m03:34:34.749609 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 20: select * from f;
                        ^

[0m03:34:34.751210 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: ROLLBACK
[0m03:34:34.752290 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: Close
[0m03:34:34.763541 [debug] [Thread-1 (]: Database Error in model fact_factors (models/fact_factors.sql)
  syntax error at or near ";"
  LINE 20: select * from f;
                          ^
  compiled code at target/run/market_mvp/models/fact_factors.sql
[0m03:34:34.768047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cd7bcd2-c196-47df-9611-dfbbbf22f405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff833db920>]}
[0m03:34:34.769971 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.fact_factors ....................... [[31mERROR[0m in 0.06s]
[0m03:34:34.772182 [debug] [Thread-1 (]: Finished running node model.market_mvp.fact_factors
[0m03:34:34.773765 [debug] [Thread-4 (]: Marking all children of 'model.market_mvp.fact_factors' to be skipped because of status 'error'.  Reason: Database Error in model fact_factors (models/fact_factors.sql)
  syntax error at or near ";"
  LINE 20: select * from f;
                          ^
  compiled code at target/run/market_mvp/models/fact_factors.sql.
[0m03:34:34.777923 [debug] [MainThread]: Using postgres connection "master"
[0m03:34:34.780966 [debug] [MainThread]: On master: BEGIN
[0m03:34:34.781509 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:34:34.810352 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m03:34:34.811771 [debug] [MainThread]: On master: COMMIT
[0m03:34:34.815445 [debug] [MainThread]: Using postgres connection "master"
[0m03:34:34.818217 [debug] [MainThread]: On master: COMMIT
[0m03:34:34.819662 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:34:34.820071 [debug] [MainThread]: On master: Close
[0m03:34:34.820532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:34:34.820912 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m03:34:34.821280 [debug] [MainThread]: Connection 'model.market_mvp.fact_factors' was properly closed.
[0m03:34:34.821883 [info ] [MainThread]: 
[0m03:34:34.822164 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m03:34:34.822824 [debug] [MainThread]: Command end result
[0m03:34:34.857660 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m03:34:34.862112 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m03:34:34.868862 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m03:34:34.869342 [info ] [MainThread]: 
[0m03:34:34.870018 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m03:34:34.870367 [info ] [MainThread]: 
[0m03:34:34.870707 [error] [MainThread]: [31mFailure in model fact_bars_1m (models/fact_bars_1m.sql)[0m
[0m03:34:34.871405 [error] [MainThread]:   Database Error in model fact_bars_1m (models/fact_bars_1m.sql)
  syntax error at or near ";"
  LINE 26: select symbol, ts, open, high, low, close, volume from agg;
                                                                     ^
  compiled code at target/run/market_mvp/models/fact_bars_1m.sql
[0m03:34:34.871935 [info ] [MainThread]: 
[0m03:34:34.872311 [info ] [MainThread]:   compiled code at target/compiled/market_mvp/models/fact_bars_1m.sql
[0m03:34:34.872772 [info ] [MainThread]: 
[0m03:34:34.873170 [error] [MainThread]: [31mFailure in model fact_factors (models/fact_factors.sql)[0m
[0m03:34:34.873844 [error] [MainThread]:   Database Error in model fact_factors (models/fact_factors.sql)
  syntax error at or near ";"
  LINE 20: select * from f;
                          ^
  compiled code at target/run/market_mvp/models/fact_factors.sql
[0m03:34:34.874786 [info ] [MainThread]: 
[0m03:34:34.875475 [info ] [MainThread]:   compiled code at target/compiled/market_mvp/models/fact_factors.sql
[0m03:34:34.875729 [info ] [MainThread]: 
[0m03:34:34.875981 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m03:34:34.877543 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7876796, "process_in_blocks": "0", "process_kernel_time": 0.447096, "process_mem_max_rss": "123124", "process_out_blocks": "4094", "process_user_time": 2.101554}
[0m03:34:34.878390 [debug] [MainThread]: Command `dbt run` failed at 03:34:34.878302 after 0.79 seconds
[0m03:34:34.878905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff859943b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff859975f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8444c350>]}
[0m03:34:34.879273 [debug] [MainThread]: Flushing usage events
[0m03:34:35.300919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:36:12.493332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8de27b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb83470b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8e8f4d0>]}


============================== 03:36:12.498409 | f1413865-955f-49c4-b6c8-1dcb3c5bf59d ==============================
[0m03:36:12.498409 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m03:36:12.498757 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/dbt -q', 'use_experimental_parser': 'False', 'debug': 'False', 'printer_width': '80', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'quiet': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'target_path': 'None', 'profiles_dir': '/opt/dbt', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'empty': 'False', 'write_json': 'True', 'log_path': '/opt/dbt/logs', 'fail_fast': 'False', 'introspect': 'True', 'warn_error': 'None'}
[0m03:36:12.608421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1413865-955f-49c4-b6c8-1dcb3c5bf59d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb763c080>]}
[0m03:36:12.643360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1413865-955f-49c4-b6c8-1dcb3c5bf59d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb75e45f0>]}
[0m03:36:12.644163 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:36:12.691298 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m03:36:12.757970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:36:12.758914 [debug] [MainThread]: Partial parsing: updated file: market_mvp://models/fact_factors.sql
[0m03:36:12.759250 [debug] [MainThread]: Partial parsing: updated file: market_mvp://models/fact_bars_1m.sql
[0m03:36:12.895585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1413865-955f-49c4-b6c8-1dcb3c5bf59d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb70db6b0>]}
[0m03:36:12.930298 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m03:36:12.931911 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m03:36:12.968813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1413865-955f-49c4-b6c8-1dcb3c5bf59d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb71afce0>]}
[0m03:36:12.969285 [info ] [MainThread]: Found 2 models, 446 macros
[0m03:36:12.969501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1413865-955f-49c4-b6c8-1dcb3c5bf59d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb71832f0>]}
[0m03:36:12.970613 [info ] [MainThread]: 
[0m03:36:12.970870 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:36:12.971045 [info ] [MainThread]: 
[0m03:36:12.971363 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:36:12.973672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m03:36:12.994123 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m03:36:12.994493 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m03:36:12.994772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:36:13.003689 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m03:36:13.004625 [debug] [ThreadPool]: On list_airflow: Close
[0m03:36:13.005537 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m03:36:13.008889 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m03:36:13.009163 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m03:36:13.009373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:36:13.013160 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m03:36:13.013495 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m03:36:13.013754 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:36:13.016008 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.002 seconds
[0m03:36:13.017155 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m03:36:13.017538 [debug] [ThreadPool]: On list_airflow_public: Close
[0m03:36:13.027973 [debug] [MainThread]: Using postgres connection "master"
[0m03:36:13.028477 [debug] [MainThread]: On master: BEGIN
[0m03:36:13.028715 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:36:13.033013 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m03:36:13.033431 [debug] [MainThread]: Using postgres connection "master"
[0m03:36:13.033710 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:36:13.046708 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m03:36:13.047718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1413865-955f-49c4-b6c8-1dcb3c5bf59d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb74f30e0>]}
[0m03:36:13.048063 [debug] [MainThread]: On master: ROLLBACK
[0m03:36:13.048426 [debug] [MainThread]: Using postgres connection "master"
[0m03:36:13.048676 [debug] [MainThread]: On master: BEGIN
[0m03:36:13.049084 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:36:13.049333 [debug] [MainThread]: On master: COMMIT
[0m03:36:13.049554 [debug] [MainThread]: Using postgres connection "master"
[0m03:36:13.049760 [debug] [MainThread]: On master: COMMIT
[0m03:36:13.050029 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:36:13.050245 [debug] [MainThread]: On master: Close
[0m03:36:13.052876 [debug] [Thread-1 (]: Began running node model.market_mvp.fact_bars_1m
[0m03:36:13.053307 [info ] [Thread-1 (]: 1 of 2 START sql view model public.fact_bars_1m ................................ [RUN]
[0m03:36:13.053644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.market_mvp.fact_bars_1m)
[0m03:36:13.053953 [debug] [Thread-1 (]: Began compiling node model.market_mvp.fact_bars_1m
[0m03:36:13.057661 [debug] [Thread-1 (]: Writing injected SQL for node "model.market_mvp.fact_bars_1m"
[0m03:36:13.058650 [debug] [Thread-1 (]: Began executing node model.market_mvp.fact_bars_1m
[0m03:36:13.077307 [debug] [Thread-1 (]: Writing runtime sql for node "model.market_mvp.fact_bars_1m"
[0m03:36:13.078195 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:36:13.078460 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: BEGIN
[0m03:36:13.078727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:36:13.082531 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m03:36:13.082790 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:36:13.083009 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_bars_1m"} */

  create view "airflow"."public"."fact_bars_1m__dbt_tmp"
    
    
  as (
    with t as (
  select symbol, date_trunc('minute', ts) as ts_min, ts, price::numeric as price, size::int as size
  from stg_trades
),
open_close as (
  select
    symbol, ts_min,
    first_value(price) over (partition by symbol, ts_min order by ts asc)  as open,
    first_value(price) over (partition by symbol, ts_min order by ts desc) as close
  from t
),
hlv as (
  select symbol, ts_min, min(price) as low, max(price) as high, sum(size) as volume
  from t
  group by symbol, ts_min
)
select
  h.symbol,
  h.ts_min as ts,
  o.open, h.high, h.low, o.close, h.volume
from hlv h
join open_close o using (symbol, ts_min)
order by 1,2
  );
[0m03:36:13.092939 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m03:36:13.096576 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:36:13.096890 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_bars_1m"} */
alter table "airflow"."public"."fact_bars_1m__dbt_tmp" rename to "fact_bars_1m"
[0m03:36:13.097815 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:36:13.105248 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: COMMIT
[0m03:36:13.105543 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:36:13.105765 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: COMMIT
[0m03:36:13.108377 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m03:36:13.111478 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."fact_bars_1m__dbt_backup"
[0m03:36:13.114017 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:36:13.114277 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_bars_1m"} */
drop view if exists "airflow"."public"."fact_bars_1m__dbt_backup" cascade
[0m03:36:13.114910 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m03:36:13.116229 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: Close
[0m03:36:13.117262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1413865-955f-49c4-b6c8-1dcb3c5bf59d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbabab260>]}
[0m03:36:13.117727 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.fact_bars_1m ........................... [[32mCREATE VIEW[0m in 0.06s]
[0m03:36:13.118104 [debug] [Thread-1 (]: Finished running node model.market_mvp.fact_bars_1m
[0m03:36:13.118387 [debug] [Thread-1 (]: Began running node model.market_mvp.fact_factors
[0m03:36:13.118738 [info ] [Thread-1 (]: 2 of 2 START sql view model public.fact_factors ................................ [RUN]
[0m03:36:13.118996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.market_mvp.fact_bars_1m, now model.market_mvp.fact_factors)
[0m03:36:13.119216 [debug] [Thread-1 (]: Began compiling node model.market_mvp.fact_factors
[0m03:36:13.120209 [debug] [Thread-1 (]: Writing injected SQL for node "model.market_mvp.fact_factors"
[0m03:36:13.120859 [debug] [Thread-1 (]: Began executing node model.market_mvp.fact_factors
[0m03:36:13.122904 [debug] [Thread-1 (]: Writing runtime sql for node "model.market_mvp.fact_factors"
[0m03:36:13.123424 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_factors"
[0m03:36:13.123652 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: BEGIN
[0m03:36:13.123857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:36:13.127455 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m03:36:13.127721 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_factors"
[0m03:36:13.127935 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_factors"} */

  create view "airflow"."public"."fact_factors__dbt_tmp"
    
    
  as (
    with q as (
  select symbol, ts, (bid+ask)/2.0 as mid, (ask-bid) as spread
  from stg_quotes
),
f as (
  select
    symbol, ts,
    10000*spread/nullif(mid,0) as spread_bp,
    stddev_samp(mid) over (partition by symbol order by ts rows between 5 preceding and current row)  as vol_5m,
    stddev_samp(mid) over (partition by symbol rows between 30 preceding and current row order by ts) as vol_30m,
    mid as fair_value
  from q
)
select * from f
  );
[0m03:36:13.128370 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "order"
LINE 16: ... symbol rows between 30 preceding and current row order by t...
                                                              ^

[0m03:36:13.128699 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: ROLLBACK
[0m03:36:13.129025 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: Close
[0m03:36:13.131280 [debug] [Thread-1 (]: Database Error in model fact_factors (models/fact_factors.sql)
  syntax error at or near "order"
  LINE 16: ... symbol rows between 30 preceding and current row order by t...
                                                                ^
  compiled code at target/run/market_mvp/models/fact_factors.sql
[0m03:36:13.131660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1413865-955f-49c4-b6c8-1dcb3c5bf59d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb617d820>]}
[0m03:36:13.132091 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.fact_factors ....................... [[31mERROR[0m in 0.01s]
[0m03:36:13.134042 [debug] [Thread-1 (]: Finished running node model.market_mvp.fact_factors
[0m03:36:13.135015 [debug] [Thread-4 (]: Marking all children of 'model.market_mvp.fact_factors' to be skipped because of status 'error'.  Reason: Database Error in model fact_factors (models/fact_factors.sql)
  syntax error at or near "order"
  LINE 16: ... symbol rows between 30 preceding and current row order by t...
                                                                ^
  compiled code at target/run/market_mvp/models/fact_factors.sql.
[0m03:36:13.137457 [debug] [MainThread]: Using postgres connection "master"
[0m03:36:13.137904 [debug] [MainThread]: On master: BEGIN
[0m03:36:13.138196 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:36:13.143021 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m03:36:13.143460 [debug] [MainThread]: On master: COMMIT
[0m03:36:13.143765 [debug] [MainThread]: Using postgres connection "master"
[0m03:36:13.144006 [debug] [MainThread]: On master: COMMIT
[0m03:36:13.144319 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:36:13.144555 [debug] [MainThread]: On master: Close
[0m03:36:13.144938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:36:13.145180 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m03:36:13.145385 [debug] [MainThread]: Connection 'model.market_mvp.fact_factors' was properly closed.
[0m03:36:13.145711 [info ] [MainThread]: 
[0m03:36:13.145965 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m03:36:13.146494 [debug] [MainThread]: Command end result
[0m03:36:13.161165 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m03:36:13.162601 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m03:36:13.166357 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m03:36:13.166641 [info ] [MainThread]: 
[0m03:36:13.166909 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:36:13.167126 [info ] [MainThread]: 
[0m03:36:13.167365 [error] [MainThread]: [31mFailure in model fact_factors (models/fact_factors.sql)[0m
[0m03:36:13.167705 [error] [MainThread]:   Database Error in model fact_factors (models/fact_factors.sql)
  syntax error at or near "order"
  LINE 16: ... symbol rows between 30 preceding and current row order by t...
                                                                ^
  compiled code at target/run/market_mvp/models/fact_factors.sql
[0m03:36:13.168040 [info ] [MainThread]: 
[0m03:36:13.168285 [info ] [MainThread]:   compiled code at target/compiled/market_mvp/models/fact_factors.sql
[0m03:36:13.168487 [info ] [MainThread]: 
[0m03:36:13.168728 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m03:36:13.169722 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7074876, "process_in_blocks": "0", "process_kernel_time": 0.300791, "process_mem_max_rss": "126352", "process_out_blocks": "4943", "process_user_time": 2.037133}
[0m03:36:13.170154 [debug] [MainThread]: Command `dbt run` failed at 03:36:13.170100 after 0.71 seconds
[0m03:36:13.170430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb0c9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb760fef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5d98920>]}
[0m03:36:13.170678 [debug] [MainThread]: Flushing usage events
[0m03:36:13.482541 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:37:47.932800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d3f94c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b345610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d711f70>]}


============================== 03:37:47.937964 | dde29193-69e6-4c37-b899-9b2d3aa69eed ==============================
[0m03:37:47.937964 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m03:37:47.938324 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'profiles_dir': '/opt/dbt', 'no_print': 'None', 'warn_error': 'None', 'log_path': '/opt/dbt/logs', 'debug': 'False', 'write_json': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'target_path': 'None', 'printer_width': '80', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/dbt -q', 'indirect_selection': 'eager', 'partial_parse': 'True', 'quiet': 'True', 'static_parser': 'True'}
[0m03:37:48.042461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dde29193-69e6-4c37-b899-9b2d3aa69eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8987efc0>]}
[0m03:37:48.073698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dde29193-69e6-4c37-b899-9b2d3aa69eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af451f0>]}
[0m03:37:48.074270 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:37:48.123550 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m03:37:48.167054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:37:48.167513 [debug] [MainThread]: Partial parsing: updated file: market_mvp://models/fact_factors.sql
[0m03:37:48.289548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dde29193-69e6-4c37-b899-9b2d3aa69eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8953e540>]}
[0m03:37:48.325067 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m03:37:48.326705 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m03:37:48.358658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dde29193-69e6-4c37-b899-9b2d3aa69eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8953fd70>]}
[0m03:37:48.359029 [info ] [MainThread]: Found 2 models, 446 macros
[0m03:37:48.359245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dde29193-69e6-4c37-b899-9b2d3aa69eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89538530>]}
[0m03:37:48.360266 [info ] [MainThread]: 
[0m03:37:48.360498 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:37:48.360675 [info ] [MainThread]: 
[0m03:37:48.360969 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:37:48.363125 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m03:37:48.388598 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m03:37:48.389048 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m03:37:48.389289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:37:48.401864 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.013 seconds
[0m03:37:48.403026 [debug] [ThreadPool]: On list_airflow: Close
[0m03:37:48.404154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m03:37:48.408578 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m03:37:48.408945 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m03:37:48.409190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:37:48.413513 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m03:37:48.413949 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m03:37:48.414190 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:37:48.421002 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.006 seconds
[0m03:37:48.422580 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m03:37:48.422934 [debug] [ThreadPool]: On list_airflow_public: Close
[0m03:37:48.430053 [debug] [MainThread]: Using postgres connection "master"
[0m03:37:48.430353 [debug] [MainThread]: On master: BEGIN
[0m03:37:48.430553 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:37:48.435058 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m03:37:48.435426 [debug] [MainThread]: Using postgres connection "master"
[0m03:37:48.435716 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:37:48.451161 [debug] [MainThread]: SQL status: SELECT 1 in 0.015 seconds
[0m03:37:48.452432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dde29193-69e6-4c37-b899-9b2d3aa69eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8963e570>]}
[0m03:37:48.452792 [debug] [MainThread]: On master: ROLLBACK
[0m03:37:48.453221 [debug] [MainThread]: Using postgres connection "master"
[0m03:37:48.453468 [debug] [MainThread]: On master: BEGIN
[0m03:37:48.453885 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:37:48.454168 [debug] [MainThread]: On master: COMMIT
[0m03:37:48.454382 [debug] [MainThread]: Using postgres connection "master"
[0m03:37:48.454595 [debug] [MainThread]: On master: COMMIT
[0m03:37:48.454898 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:37:48.455168 [debug] [MainThread]: On master: Close
[0m03:37:48.458444 [debug] [Thread-1 (]: Began running node model.market_mvp.fact_bars_1m
[0m03:37:48.458890 [info ] [Thread-1 (]: 1 of 2 START sql view model public.fact_bars_1m ................................ [RUN]
[0m03:37:48.459217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.market_mvp.fact_bars_1m)
[0m03:37:48.459504 [debug] [Thread-1 (]: Began compiling node model.market_mvp.fact_bars_1m
[0m03:37:48.463502 [debug] [Thread-1 (]: Writing injected SQL for node "model.market_mvp.fact_bars_1m"
[0m03:37:48.464484 [debug] [Thread-1 (]: Began executing node model.market_mvp.fact_bars_1m
[0m03:37:48.483983 [debug] [Thread-1 (]: Writing runtime sql for node "model.market_mvp.fact_bars_1m"
[0m03:37:48.484773 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:37:48.485028 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: BEGIN
[0m03:37:48.485244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:37:48.489407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m03:37:48.489696 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:37:48.489981 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_bars_1m"} */

  create view "airflow"."public"."fact_bars_1m__dbt_tmp"
    
    
  as (
    with t as (
  select symbol, date_trunc('minute', ts) as ts_min, ts, price::numeric as price, size::int as size
  from stg_trades
),
open_close as (
  select
    symbol, ts_min,
    first_value(price) over (partition by symbol, ts_min order by ts asc)  as open,
    first_value(price) over (partition by symbol, ts_min order by ts desc) as close
  from t
),
hlv as (
  select symbol, ts_min, min(price) as low, max(price) as high, sum(size) as volume
  from t
  group by symbol, ts_min
)
select
  h.symbol,
  h.ts_min as ts,
  o.open, h.high, h.low, o.close, h.volume
from hlv h
join open_close o using (symbol, ts_min)
order by 1,2
  );
[0m03:37:48.494681 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m03:37:48.498650 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:37:48.498953 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_bars_1m"} */
alter table "airflow"."public"."fact_bars_1m" rename to "fact_bars_1m__dbt_backup"
[0m03:37:48.499506 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:37:48.501062 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:37:48.501292 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_bars_1m"} */
alter table "airflow"."public"."fact_bars_1m__dbt_tmp" rename to "fact_bars_1m"
[0m03:37:48.501695 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:37:48.510255 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: COMMIT
[0m03:37:48.510545 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:37:48.510762 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: COMMIT
[0m03:37:48.512037 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:37:48.515238 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."fact_bars_1m__dbt_backup"
[0m03:37:48.517908 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:37:48.518180 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_bars_1m"} */
drop view if exists "airflow"."public"."fact_bars_1m__dbt_backup" cascade
[0m03:37:48.519682 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:37:48.521541 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: Close
[0m03:37:48.523274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dde29193-69e6-4c37-b899-9b2d3aa69eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ced40e0>]}
[0m03:37:48.524054 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.fact_bars_1m ........................... [[32mCREATE VIEW[0m in 0.06s]
[0m03:37:48.524584 [debug] [Thread-1 (]: Finished running node model.market_mvp.fact_bars_1m
[0m03:37:48.524944 [debug] [Thread-1 (]: Began running node model.market_mvp.fact_factors
[0m03:37:48.525317 [info ] [Thread-1 (]: 2 of 2 START sql view model public.fact_factors ................................ [RUN]
[0m03:37:48.525625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.market_mvp.fact_bars_1m, now model.market_mvp.fact_factors)
[0m03:37:48.525852 [debug] [Thread-1 (]: Began compiling node model.market_mvp.fact_factors
[0m03:37:48.526971 [debug] [Thread-1 (]: Writing injected SQL for node "model.market_mvp.fact_factors"
[0m03:37:48.527594 [debug] [Thread-1 (]: Began executing node model.market_mvp.fact_factors
[0m03:37:48.529791 [debug] [Thread-1 (]: Writing runtime sql for node "model.market_mvp.fact_factors"
[0m03:37:48.530387 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_factors"
[0m03:37:48.530627 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: BEGIN
[0m03:37:48.530849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:37:48.534745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m03:37:48.535019 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_factors"
[0m03:37:48.535252 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_factors"} */

  create view "airflow"."public"."fact_factors__dbt_tmp"
    
    
  as (
    with q as (
  select
    symbol,
    ts,
    (bid + ask)/2.0 as mid,
    (ask - bid)     as spread
  from stg_quotes
),
f as (
  select
    symbol,
    ts,
    10000 * spread / nullif(mid, 0) as spread_bp,
    -- 5-row rolling volatility on mid
    stddev_samp(mid) over (
      partition by symbol
      order by ts
      rows between 5 preceding and current row
    ) as vol_5m,
    -- 30-row rolling volatility on mid (correct window syntax)
    stddev_samp(mid) over (
      partition by symbol
      order by ts
      rows between 30 preceding and current row
    ) as vol_30m,
    mid as fair_value
  from q
)
select * from f
  );
[0m03:37:48.538530 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m03:37:48.541466 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_factors"
[0m03:37:48.541886 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_factors"} */
alter table "airflow"."public"."fact_factors__dbt_tmp" rename to "fact_factors"
[0m03:37:48.542563 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:37:48.543511 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: COMMIT
[0m03:37:48.543780 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_factors"
[0m03:37:48.544005 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: COMMIT
[0m03:37:48.545327 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:37:48.546753 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."fact_factors__dbt_backup"
[0m03:37:48.547210 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_factors"
[0m03:37:48.547452 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_factors"} */
drop view if exists "airflow"."public"."fact_factors__dbt_backup" cascade
[0m03:37:48.547870 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m03:37:48.548699 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: Close
[0m03:37:48.549157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dde29193-69e6-4c37-b899-9b2d3aa69eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881803e0>]}
[0m03:37:48.549605 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.fact_factors ........................... [[32mCREATE VIEW[0m in 0.02s]
[0m03:37:48.549987 [debug] [Thread-1 (]: Finished running node model.market_mvp.fact_factors
[0m03:37:48.550862 [debug] [MainThread]: Using postgres connection "master"
[0m03:37:48.551200 [debug] [MainThread]: On master: BEGIN
[0m03:37:48.551395 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:37:48.555840 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m03:37:48.556083 [debug] [MainThread]: On master: COMMIT
[0m03:37:48.556273 [debug] [MainThread]: Using postgres connection "master"
[0m03:37:48.556438 [debug] [MainThread]: On master: COMMIT
[0m03:37:48.556659 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:37:48.556833 [debug] [MainThread]: On master: Close
[0m03:37:48.557102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:37:48.557347 [debug] [MainThread]: Connection 'model.market_mvp.fact_factors' was properly closed.
[0m03:37:48.557669 [info ] [MainThread]: 
[0m03:37:48.557917 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m03:37:48.558467 [debug] [MainThread]: Command end result
[0m03:37:48.572761 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m03:37:48.574384 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m03:37:48.578262 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m03:37:48.578485 [info ] [MainThread]: 
[0m03:37:48.578739 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:37:48.578964 [info ] [MainThread]: 
[0m03:37:48.579183 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m03:37:48.580072 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6825796, "process_in_blocks": "0", "process_kernel_time": 0.307961, "process_mem_max_rss": "126200", "process_out_blocks": "4947", "process_user_time": 1.98219}
[0m03:37:48.580436 [debug] [MainThread]: Command `dbt run` succeeded at 03:37:48.580383 after 0.68 seconds
[0m03:37:48.580692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a570ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89a55eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89a56240>]}
[0m03:37:48.580937 [debug] [MainThread]: Flushing usage events
[0m03:37:48.910527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:44:14.138961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aea1730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8cd310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7abfb6e0>]}


============================== 03:44:14.147312 | ad3ba5b4-72c5-4610-9507-0fc0be32eecc ==============================
[0m03:44:14.147312 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m03:44:14.147974 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'printer_width': '80', 'introspect': 'True', 'debug': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/dbt', 'no_print': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'version_check': 'True', 'fail_fast': 'False', 'quiet': 'False', 'log_path': '/opt/dbt/logs', 'empty': 'False', 'profiles_dir': '/opt/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'partial_parse': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error': 'None'}
[0m03:44:14.318053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad3ba5b4-72c5-4610-9507-0fc0be32eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a917440>]}
[0m03:44:14.357021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad3ba5b4-72c5-4610-9507-0fc0be32eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bcce180>]}
[0m03:44:14.358206 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:44:14.438268 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m03:44:14.541527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:44:14.542074 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:44:14.564676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad3ba5b4-72c5-4610-9507-0fc0be32eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d53290>]}
[0m03:44:14.633160 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m03:44:14.635518 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m03:44:14.668300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad3ba5b4-72c5-4610-9507-0fc0be32eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79a15550>]}
[0m03:44:14.668889 [info ] [MainThread]: Found 2 models, 446 macros
[0m03:44:14.670764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad3ba5b4-72c5-4610-9507-0fc0be32eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79b7ddc0>]}
[0m03:44:14.673249 [info ] [MainThread]: 
[0m03:44:14.676700 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:44:14.678344 [info ] [MainThread]: 
[0m03:44:14.679070 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:44:14.682648 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m03:44:14.740965 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m03:44:14.741596 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m03:44:14.741850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:44:14.753723 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.012 seconds
[0m03:44:14.755057 [debug] [ThreadPool]: On list_airflow: Close
[0m03:44:14.756905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m03:44:14.761777 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m03:44:14.762190 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m03:44:14.762403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:44:14.767834 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m03:44:14.768426 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m03:44:14.769615 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:44:14.777107 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.006 seconds
[0m03:44:14.780901 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m03:44:14.781839 [debug] [ThreadPool]: On list_airflow_public: Close
[0m03:44:14.815295 [debug] [MainThread]: Using postgres connection "master"
[0m03:44:14.817079 [debug] [MainThread]: On master: BEGIN
[0m03:44:14.817424 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:44:14.830033 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m03:44:14.830622 [debug] [MainThread]: Using postgres connection "master"
[0m03:44:14.830968 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:44:14.857066 [debug] [MainThread]: SQL status: SELECT 2 in 0.026 seconds
[0m03:44:14.858842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad3ba5b4-72c5-4610-9507-0fc0be32eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a8fbb90>]}
[0m03:44:14.859718 [debug] [MainThread]: On master: ROLLBACK
[0m03:44:14.860392 [debug] [MainThread]: Using postgres connection "master"
[0m03:44:14.860803 [debug] [MainThread]: On master: BEGIN
[0m03:44:14.861528 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:44:14.861833 [debug] [MainThread]: On master: COMMIT
[0m03:44:14.862113 [debug] [MainThread]: Using postgres connection "master"
[0m03:44:14.862356 [debug] [MainThread]: On master: COMMIT
[0m03:44:14.862652 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:44:14.862893 [debug] [MainThread]: On master: Close
[0m03:44:14.868057 [debug] [Thread-1 (]: Began running node model.market_mvp.fact_bars_1m
[0m03:44:14.868683 [info ] [Thread-1 (]: 1 of 2 START sql view model public.fact_bars_1m ................................ [RUN]
[0m03:44:14.869243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.market_mvp.fact_bars_1m)
[0m03:44:14.869725 [debug] [Thread-1 (]: Began compiling node model.market_mvp.fact_bars_1m
[0m03:44:14.874498 [debug] [Thread-1 (]: Writing injected SQL for node "model.market_mvp.fact_bars_1m"
[0m03:44:14.875474 [debug] [Thread-1 (]: Began executing node model.market_mvp.fact_bars_1m
[0m03:44:14.931366 [debug] [Thread-1 (]: Writing runtime sql for node "model.market_mvp.fact_bars_1m"
[0m03:44:14.932657 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:44:14.933033 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: BEGIN
[0m03:44:14.933331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:44:14.946719 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m03:44:14.947313 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:44:14.947857 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_bars_1m"} */

  create view "airflow"."public"."fact_bars_1m__dbt_tmp"
    
    
  as (
    with t as (
  select symbol, date_trunc('minute', ts) as ts_min, ts, price::numeric as price, size::int as size
  from stg_trades
),
open_close as (
  select
    symbol, ts_min,
    first_value(price) over (partition by symbol, ts_min order by ts asc)  as open,
    first_value(price) over (partition by symbol, ts_min order by ts desc) as close
  from t
),
hlv as (
  select symbol, ts_min, min(price) as low, max(price) as high, sum(size) as volume
  from t
  group by symbol, ts_min
)
select
  h.symbol,
  h.ts_min as ts,
  o.open, h.high, h.low, o.close, h.volume
from hlv h
join open_close o using (symbol, ts_min)
order by 1,2
  );
[0m03:44:14.955923 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m03:44:14.962068 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:44:14.962701 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_bars_1m"} */
alter table "airflow"."public"."fact_bars_1m" rename to "fact_bars_1m__dbt_backup"
[0m03:44:14.964115 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:44:14.966253 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:44:14.966628 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_bars_1m"} */
alter table "airflow"."public"."fact_bars_1m__dbt_tmp" rename to "fact_bars_1m"
[0m03:44:14.967236 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:44:14.977089 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: COMMIT
[0m03:44:14.977597 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:44:14.977882 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: COMMIT
[0m03:44:14.981799 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m03:44:14.985566 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."fact_bars_1m__dbt_backup"
[0m03:44:14.988467 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_bars_1m"
[0m03:44:14.988748 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_bars_1m"} */
drop view if exists "airflow"."public"."fact_bars_1m__dbt_backup" cascade
[0m03:44:14.990994 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m03:44:14.992848 [debug] [Thread-1 (]: On model.market_mvp.fact_bars_1m: Close
[0m03:44:14.994225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad3ba5b4-72c5-4610-9507-0fc0be32eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78e3ebd0>]}
[0m03:44:14.994758 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.fact_bars_1m ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m03:44:14.995608 [debug] [Thread-1 (]: Finished running node model.market_mvp.fact_bars_1m
[0m03:44:14.996220 [debug] [Thread-1 (]: Began running node model.market_mvp.fact_factors
[0m03:44:14.996642 [info ] [Thread-1 (]: 2 of 2 START sql view model public.fact_factors ................................ [RUN]
[0m03:44:14.996966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.market_mvp.fact_bars_1m, now model.market_mvp.fact_factors)
[0m03:44:14.997210 [debug] [Thread-1 (]: Began compiling node model.market_mvp.fact_factors
[0m03:44:14.998277 [debug] [Thread-1 (]: Writing injected SQL for node "model.market_mvp.fact_factors"
[0m03:44:14.998987 [debug] [Thread-1 (]: Began executing node model.market_mvp.fact_factors
[0m03:44:15.001231 [debug] [Thread-1 (]: Writing runtime sql for node "model.market_mvp.fact_factors"
[0m03:44:15.001867 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_factors"
[0m03:44:15.002156 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: BEGIN
[0m03:44:15.002415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:44:15.008851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m03:44:15.009218 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_factors"
[0m03:44:15.009505 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_factors"} */

  create view "airflow"."public"."fact_factors__dbt_tmp"
    
    
  as (
    with q as (
  select
    symbol,
    ts,
    (bid + ask)/2.0 as mid,
    (ask - bid)     as spread
  from stg_quotes
),
f as (
  select
    symbol,
    ts,
    10000 * spread / nullif(mid, 0) as spread_bp,
    -- 5-row rolling volatility on mid
    stddev_samp(mid) over (
      partition by symbol
      order by ts
      rows between 5 preceding and current row
    ) as vol_5m,
    -- 30-row rolling volatility on mid (correct window syntax)
    stddev_samp(mid) over (
      partition by symbol
      order by ts
      rows between 30 preceding and current row
    ) as vol_30m,
    mid as fair_value
  from q
)
select * from f
  );
[0m03:44:15.014667 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m03:44:15.016932 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_factors"
[0m03:44:15.017232 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_factors"} */
alter table "airflow"."public"."fact_factors" rename to "fact_factors__dbt_backup"
[0m03:44:15.017706 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:44:15.019374 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_factors"
[0m03:44:15.019738 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_factors"} */
alter table "airflow"."public"."fact_factors__dbt_tmp" rename to "fact_factors"
[0m03:44:15.020246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:44:15.021423 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: COMMIT
[0m03:44:15.021727 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_factors"
[0m03:44:15.022029 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: COMMIT
[0m03:44:15.024102 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m03:44:15.026774 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."fact_factors__dbt_backup"
[0m03:44:15.027656 [debug] [Thread-1 (]: Using postgres connection "model.market_mvp.fact_factors"
[0m03:44:15.028017 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "market_profile", "target_name": "dev", "node_id": "model.market_mvp.fact_factors"} */
drop view if exists "airflow"."public"."fact_factors__dbt_backup" cascade
[0m03:44:15.030006 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m03:44:15.031534 [debug] [Thread-1 (]: On model.market_mvp.fact_factors: Close
[0m03:44:15.032577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad3ba5b4-72c5-4610-9507-0fc0be32eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78ec76e0>]}
[0m03:44:15.033760 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.fact_factors ........................... [[32mCREATE VIEW[0m in 0.04s]
[0m03:44:15.034668 [debug] [Thread-1 (]: Finished running node model.market_mvp.fact_factors
[0m03:44:15.036502 [debug] [MainThread]: Using postgres connection "master"
[0m03:44:15.036943 [debug] [MainThread]: On master: BEGIN
[0m03:44:15.037247 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:44:15.045305 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m03:44:15.045826 [debug] [MainThread]: On master: COMMIT
[0m03:44:15.046084 [debug] [MainThread]: Using postgres connection "master"
[0m03:44:15.046364 [debug] [MainThread]: On master: COMMIT
[0m03:44:15.046732 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:44:15.046978 [debug] [MainThread]: On master: Close
[0m03:44:15.047466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:44:15.048109 [debug] [MainThread]: Connection 'model.market_mvp.fact_factors' was properly closed.
[0m03:44:15.049251 [info ] [MainThread]: 
[0m03:44:15.049903 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m03:44:15.050940 [debug] [MainThread]: Command end result
[0m03:44:15.072700 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m03:44:15.075633 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m03:44:15.080806 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m03:44:15.081198 [info ] [MainThread]: 
[0m03:44:15.081594 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:44:15.081947 [info ] [MainThread]: 
[0m03:44:15.082266 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m03:44:15.083710 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9897089, "process_in_blocks": "0", "process_kernel_time": 0.851114, "process_mem_max_rss": "121608", "process_out_blocks": "1739", "process_user_time": 2.513115}
[0m03:44:15.084372 [debug] [MainThread]: Command `dbt run` succeeded at 03:44:15.084286 after 0.99 seconds
[0m03:44:15.084844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd29af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bcf7cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bcf6810>]}
[0m03:44:15.085209 [debug] [MainThread]: Flushing usage events
[0m03:44:15.460117 [debug] [MainThread]: An error was encountered while trying to flush usage events
